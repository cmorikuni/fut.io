<html>
<head>
    <link rel="stylesheet" type="text/css" href="https://cmorikuni.github.io/fut.io/style.css">
    <title>FUT Randomizer</title>
</head>

<body class="sansserif">
<!--
FEATURES:
DONE: numbers (1-99)
DONE: simple equations ([0-9] +,- [0-9])
DONE: toggle numbers/equations
DONE: toggle start/stop by touching number
DONE: implement shapes
toggle shape (if shape enabled then shapes use selected colors, background uses all colors)
center numbers better when shapes are visible
if colors collide, increment the second color by 1 or wrap back to 0
colors for numbers
-->

<script>
  var futTimer = undefined;
  var intervalTime = 2000;
  var allColors = ["red", "yellow", "blue", "orange", "white", "black", "green", "purple"];
  var activeColors = ["red", "yellow", "blue", "orange"];
  
  var operators = ["+", "-"]
  var maxNumber = 9;
  var maxEquationNum = 9;
  
  var shapes = {
    "circle": '<circle id="shape" cx="50%" cy="50%" r="45" fill="green" stroke="black" stroke-width=".5"></circle>',
    "oval": '<ellipse id="shape" cx="50%" cy="50%" rx="50" ry="35" fill="green" stroke="black" stroke-width=".5"></ellipse>', 
    "triangle": '<polygon id="shape" points="0,-40 40,40 -40,40" transform="translate(50,50)" fill="green" stroke="black" stroke-width=".5"></polygon>', 
    "square": '<polygon id="shape" points="-40,-40 40,-40 40,40 -40,40" transform="translate(50,50)" fill="green" stroke="black" stroke-width=".5"></polygon>', 
    "rectangle": '<polygon id="shape" points="-45,-30 45,-30 45,30 -45,30" transform="translate(50,50)" fill="green" stroke="black" stroke-width=".5"></polygon>', 
    "rhombus": '<polygon id="shape" points="0,-45 45,45 0,45 -45,-45" transform="translate(50,50)" fill="green" stroke="black" stroke-width=".5"></polygon>', 
    "diamond": '<polygon id="shape" points="0,-45 42,0 0,45 -42,0" transform="translate(50,50)" fill="green" stroke="black" stroke-width=".5"></polygon>', 
    "trapezoid": '<polygon id="shape" points="-30,-35 30,-35 55,35 -55,35" transform="translate(50,50)" fill="green" stroke="black" stroke-width=".5"></polygon>', 
    "pentagon": '<polygon id="shape" points="-45,-22 -45,22 0,45 45,22 45,-22 0,-45" transform="translate(50,50)" fill="green" stroke="black" stroke-width=".5"></polygon>'
  }
    
  var isNumber = true;
  var isBackground = true;
  
  function toggleTimer(elem) {
    if (window.futTimer) {
      clearInterval(futTimer);
      futTimer = undefined;
      document.body.style.backgroundColor = "white";
      elem.style.color = "white";
    } else {
      randomize();
      futTimer = setInterval(randomize, intervalTime);
      elem.style.color = "lightslategray";
    }
  };
  
  function randomize() {
    let randA = Math.random();
    let randB = Math.random();
    let randC = Math.random();
    let randBackClr = Math.random();
    let randShape = Math.random();
    let randShapeClr = Math.random();
      
    // set number
    firstNum = Math.floor(randA * maxNumber) + 1;
    secondNum = Math.floor(randB * maxNumber) + 1;
    op = operators[Math.floor(randC * operators.length)];
    if (isNumber) {
      document.getElementById("numbers").innerHTML = Math.floor(randA * maxNumber) + 1; 
    } else {
      document.getElementById("numbers").innerHTML = Math.max(firstNum, secondNum) + op + Math.min(firstNum, secondNum);
    }
      
    // set background color
    if (isBackground) {
      // clear shape
      document.getElementById("shapes").innerHTML = "";
      
      // set background color from activeColors
      let bkClrInd = Math.floor(randBackClr * activeColors.length);
      let bkClr = activeColors[bkClrInd];
      document.body.style.backgroundColor = bkClr;
    } else {
      // set shape
      let shpInd = Math.floor(randShape * Object.keys(shapes).length);
      let shpKey = Object.keys(shapes)[shpInd];
      let shapeVal = shapes[shpKey];
      
      let shpClrInd = Math.floor(randShapeClr * activeColors.length);
      let shpClr = activeColors[shpClrInd];
      
      document.getElementById("shapes").innerHTML = shapeVal;
      document.getElementById("shape").style.fill = shpClr;

      // set background color from allColors
      let bkClrInd = Math.floor(randBackClr * allColors.length);
      let bkClr = activeColors[bkClrInd];
      document.body.style.backgroundColor = bkClr;
    }
  };
    
  function clickColor(elem) {
    // Enabled = -40px, Disabled = -90px
    let index = activeColors.indexOf(elem.id);
    if (index >= 0) {
      activeColors.splice( index, 1 );
      elem.style.left = "-90px";
    } else {
      activeColors.push(elem.id);
      elem.style.left = "-40px";
    }

    return true;
  };    
   
  function toggleNumber(button) {
    if (isNumber) {
      isNumber = false;
      button.innerHTML = "Numbers";
    } else {
      isNumber = true;
      button.innerHTML = "Equations";
    }
  };
    
  function toggleShape(button) {
    if (isBackground) {
      isBackground = false;
      button.innerHTML = "Background";
    } else {
      isBackground = true;
      button.innerHTML = "Shapes";
    }
  };  
  
  function run() {
    console.log(">> RUN");
    // initialize color tags
    for (clrInd in activeColors) {
      let clr = activeColors[clrInd];
      let elem = document.getElementById(clr);
      elem.style.left = "-40px";
    }
    
    // initialize interval timer
    isRunning = true;
    randomize();
    futTimer = setInterval(randomize, intervalTime);
  }

  // in case the document is already rendered
  if (document.readyState!='loading') run();
  // modern browsers
  else if (document.addEventListener) document.addEventListener('DOMContentLoaded', run);
  // IE <= 8
  else document.attachEvent('onreadystatechange', function(){
    if (document.readyState=='complete') run();
  });
</script>
    
  <div id="mySidenav" class="sidenav">
    <a href="javascript:void(0);" id="red" onclick="clickColor(this);"></a>
    <a href="javascript:void(0);" id="yellow" onclick="clickColor(this);"></a>
    <a href="javascript:void(0);" id="blue" onclick="clickColor(this);"></a>
    <a href="javascript:void(0);" id="orange" onclick="clickColor(this);"></a>
    <a href="javascript:void(0);" id="white" onclick="clickColor(this);"></a>
    <a href="javascript:void(0);" id="black" onclick="clickColor(this);"></a>
    <a href="javascript:void(0);" id="green" onclick="clickColor(this);"></a>
    <a href="javascript:void(0);" id="purple" onclick="clickColor(this);"></a>
  </div>
  
  <h1 id="numbers" onclick="toggleTimer(this)"></h1>

  <svg version="1.1" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid meet" id="shapes">
  </svg>
      
  <div id="buttons">
    <button id="numToggle" onclick="toggleNumber(this)">Equations</button>
    <button id="shapeToggle" onclick="toggleShape(this)">Shapes</button>
  </div>
</body>
